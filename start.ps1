# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–¥–∏—Ä–æ–≤–∫—É –∫–æ–Ω—Å–æ–ª–∏ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–æ–≤
[Console]::OutputEncoding = [System.Text.Encoding]::UTF8

Write-Host "=================================================" -ForegroundColor Green
Write-Host "üöÄ –ó–ê–ü–£–°–ö –°–ò–°–¢–ï–ú–´ SHORTS NEWS –í –ß–ò–°–¢–û–ú –û–ö–†–£–ñ–ï–ù–ò–ò" -ForegroundColor Green
Write-Host "================================================="
Write-Host ""

# --- –®–∞–≥ 1: –û—á–∏—Å—Ç–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è ---
Write-Host "üßπ [1/3] –û—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö API –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏..."
Write-Host "   - –£–¥–∞–ª–µ–Ω–∏–µ Env:GOOGLE_GENAI_USE_VERTEXAI..."
Remove-Item Env:GOOGLE_GENAI_USE_VERTEXAI -ErrorAction SilentlyContinue
Write-Host "‚úÖ –ö–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã, —Ä–∞–±–æ—á–∏–µ API –∫–ª—é—á–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã."
Write-Host ""

# --- –®–∞–≥ 2: –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è ---
Write-Host "üêç [2/3] –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è (venv)..."
if (-not (Test-Path ".\venv\Scripts\Activate.ps1")) {
    Write-Host "‚ùå –û–®–ò–ë–ö–ê: –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!" -ForegroundColor Red
    Write-Host "   –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ø–∞–ø–∫–∞ 'venv'." -ForegroundColor Yellow
    exit 1
}
try {
    .\venv\Scripts\Activate.ps1
    Write-Host "‚úÖ –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ."
} catch {
    Write-Host "‚ùå –û–®–ò–ë–ö–ê: –ù–µ —É–¥–∞–ª–æ—Å—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ." -ForegroundColor Red
    Write-Host $_
    exit 1
}
Write-Host ""

# --- –®–∞–≥ 3: –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ---
Write-Host "ü§ñ [3/3] –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π (start.py)..."
Write-Host "-----------------------------------------------------------------"
Write-Host "–°–∫—Ä–∏–ø—Ç –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –≤—Å–µ –æ–∂–∏–¥–∞—é—â–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è."
Write-Host "–î–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∫–∞–Ω–∞–ª–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ start_monitor.bat –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ."
Write-Host "-----------------------------------------------------------------"
Write-Host ""

# –ó–∞–ø—É—Å–∫–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏
.\venv\Scripts\python.exe start.py

Write-Host ""
Write-Host "=================================================" -ForegroundColor Green
Write-Host "üõë –ú–û–ù–ò–¢–û–†–ò–ù–ì –û–°–¢–ê–ù–û–í–õ–ï–ù" -ForegroundColor Green
Write-Host "================================================="
